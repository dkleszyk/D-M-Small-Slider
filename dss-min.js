// Licensed under the MIT License (MIT) <http://www.opensource.org/licenses/mit-license.php>

// Copyright (c) 2011 David J. Kleszyk

var dssn={};dssn.dflt={'dwell':5000,'ftl':true,'new-slides':[],'start':1,'delta-t':10,'n-steps':50,'direction':'right','autostart':true};dssn.ac=function(el,s){var r=new RegExp(' '+s+' ','g');el.className=(' '+el.className+' ').replace(r,'').trim()+' '+s;try{this.fq()}catch(e){}};dssn.rc=function(el,s){var r=new RegExp(' '+s+' ','g');el.className=(' '+el.className+' ').replace(r,'').trim();try{this.fq()}catch(e){}};dssn.d=function(o,p){return typeof(o[p])!=='undefined'?o[p]:this.dflt[p]};dssn.m=function(d,el1,nd,el2,x0,xf,x,i,t){var dx=(xf-x0)/i,nx=x+dx;try{el1.style[d]=nx+'%'}catch(e){}try{el2.style[nd]=(100-nx)+'%'}catch(e){}if((x0<xf&&nx<xf)||(x0>xf&&nx>xf)){setTimeout(function(){dssn.m(d,el1,nd,el2,x0,xf,nx,i,t)},t)}else{try{el1.style[d]=xf+'%'}catch(e){}try{el2.style[nd]=(100-xf)+'%'}catch(e){}try{this.fq()}catch(e){}}};dssn.qq=[];dssn.q=function(f,a){dssn.qq.push({'f':f,'a':a})};dssn.fq=function(){if(this.qq.length>0){var f=this.qq[0].f,a=this.qq[0].a;this.qq=this.qq.slice(1);f.apply(this,a)}};function dss(g,o){var dw=dssn.d(o,'dwell'),ftl=dssn.d(o,'ftl'),nwl=dssn.d(o,'new-slides'),f=dssn.d(o,'start'),dt=dssn.d(o,'delta-t'),ns=dssn.d(o,'n-steps'),r=dssn.d(o,'direction'),as=dssn.d(o,'autostart'),s={},el=document.getElementById(g),im=el.getElementsByTagName('IMG'),b=el.getElementsByTagName('DT'),a=[],d=document.createElement('DIV'),w,h,em,p=document.createElement('A'),n=document.createElement('A'),l,i,e;--f;if(el.nodeName.toUpperCase()!=='DL'){return false}l=im.length;for(i=0;i<l;i++){if(!im[i].complete){setTimeout(function(){dss(g,o)},20);return}}w=el.clientWidth;h=el.clientHeight;d.className='dss-c';el.parentNode.insertBefore(d,el);el.parentNode.removeChild(el);d.appendChild(el);el.style.height='10em';em=el.offsetHeight/10.0;el.style.position='static';d.style.width=w/em+'em';d.style.height=h/em+'em';p.innerHTML='&lsaquo;';p.className='dss-ctrl prev';p.title='Previous';p.onclick=function(){s.restart();s.slide(s.ndir(),true,false)};d.appendChild(p);n.innerHTML='&rsaquo;';n.className='dss-ctrl next';n.title='Next';n.onclick=function(){s.restart();s.slide(s.dir(),true,true)};d.appendChild(n);l=nwl.length;for(i=0;i<l;i++){var ndt=document.createElement('DT');var ndd=document.createElement('DD');ndt.innerHTML=nwl[i].content;ndd.innerHTML=nwl[i].caption;el.appendChild(ndt);el.appendChild(ndd);b[b.length]=ndt}l=b.length;for(i=0;i<l;i++){e=b[i];dssn.rc(e,'on');if(i===f){dssn.ac(e,'on')}a[i]=[];while(e.nextSibling&&(e.nextSibling.nodeName.toLowerCase()==='#text'||e.nextSibling.nodeName.toUpperCase()==='DD')){e=e.nextSibling;if(e.nodeName==='#text'){continue}dssn.rc(e,'on');if(i===f){dssn.ac(e,'on')}a[i].push(e)}}s.rs=['top','right','bottom','left'];s.s=f;s.c=f;s.f=0;s.l=--l;s.t=b;s.d=a;s.ftl=ftl;s.n=ns;s.i=dt;s.w=dw;s.r=r;s.v=null;s.b=false;s.slide=function(dir,ftld,ftl){var f,ct,cd,nt,nd,ci,ni,i,n,di,ndir,adir,odir;i=this.i;n=this.n;f=this.ftl;if(ftld){f=ftl}ci=ni=this.c;if(f){ni=(++ni>this.l?this.f:ni)}else{ni=(--ni<this.f?this.l:ni)}ct=this.t[ci];cd=this.d[ci][0];nt=this.t[ni];nd=this.d[ni][0];di=this.rs.indexOf(dir);if(di<0){return}else{adir=this.rs[(di-1<0?di+3:di-1)];ndir=this.rs[(di-2<0?di+2:di-2)];odir=this.rs[(di-3<0?di+1:di-3)]}nt.style[ndir]='-100%';ct.style[dir]=ct.style[adir]=nt.style[adir]='0';ct.style[odir]=nt.style[odir]=ct.style[ndir]=nt.style[dir]='';nd.style.top='-100%';cd.style.top=cd.style.left='0';cd.style.right=cd.style.bottom=nd.style.right=nd.style.bottom='';dssn.q(dssn.ac,[nt,'on']);dssn.q(dssn.ac,[nd,'on']);dssn.q(dssn.m,['top',cd,'',null,0,-100,0,n/2,i/2]);dssn.q(dssn.m,[dir,ct,ndir,nt,0,100,0,n,i/2]);dssn.q(dssn.m,['top',nd,'',null,-100,0,-100,n/2,i/2]);dssn.q(dssn.rc,[ct,'on']);dssn.q(dssn.rc,[cd,'on']);dssn.fq();this.c=ni};s.stop=function(){clearInterval(this.v)};s.start=function(){var t,that=this;t=this.w;this.v=setInterval(function(){that.slide(that.dir())},t)};s.restart=function(){this.stop();this.start()};s.dir=function(){var di=this.rs.indexOf(this.r);if(di>=0){return this.rs[di]}else{return this.rs[Math.floor(Math.random()*4)]}};s.ndir=function(){var di=this.rs.indexOf(this.r);if(di>=0){return this.rs[(di-2<0?di+2:di-2)]}else{return this.rs[Math.floor(Math.random()*4)]}};if(as){s.start()}return s}